#ifndef UTIL_H
#define UTIL_H

#include <array>
#include <bitset>
#include <cstdint>
#include <string>

using std::bitset;
using std::string;

// Typedef

// Default ints to use
// Generally memory is not too critical, prioritize speed
typedef uint_fast32_t uintf;
typedef int_fast32_t intf;

// Ints for memory critical parts
// Generally use in large arrays
typedef uint_least8_t uint8s;
typedef uint_least16_t uint16s;

// Define constants used by the pipeline
// This is for constants used by more than one file
// Otherwise keep the constants in the file that uses it

// Size of game state sample
const uintf GAME_STATE_SIZE = 70;
// Number of possible legal moves
const uintf NUM_TOTAL_MOVES = 96;
// Number of moves the simulator uses
const uintf NUM_MOVES = 96;

enum Result { NONE, LOSS, DRAW, WIN };

inline std::array<bitset<NUM_TOTAL_MOVES>, 102> line_breakers = {
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000111000000000000100000"
                            "0000000111000000000100000000000000000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000001110000000000001000000000000000000000"
                            "0000001111000000000100000000000111000000000100"),
    bitset<NUM_TOTAL_MOVES>("00000000000010000000000000000000000000000000000000"
                            "0000001000000000000000000000000111000000000100"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000001110000000000001000000000"
                            "0001110000000000100000000000000111000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000011100000000000010000000000000000000000000"
                            "0011110111000000100000000001111111000000100000"),
    bitset<NUM_TOTAL_MOVES>("00000000100000000000000000000000000000000000000000"
                            "0010000111000000000000000001111000000000100000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000011100000000000010000000000001"
                            "1100000000000100000000000001110000000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000111000000000000100000000000000000000000000001"
                            "1101110000000100000000011111110000000100000000"),
    bitset<NUM_TOTAL_MOVES>("00001000000000000000000000000000000000000000000010"
                            "0001110000000000000000011110000000000100000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000111000000000000100000000000000000"
                            "0000000000100000000000011100000000000000000000"),
    bitset<NUM_TOTAL_MOVES>("01110000000000001000000000000000000000000000000001"
                            "1100000000100000000000111100000000100000000000"),
    bitset<NUM_TOTAL_MOVES>("10000000000000000000000000000000000000000000000001"
                            "1100000000000000000000100000000000100000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000001110000000000000000100"
                            "0000001110000000000000000000000000000000000001"),
    bitset<NUM_TOTAL_MOVES>("00000000000011100000000000000001000000000000000000"
                            "0000001111000000000001000000001110000000000001"),
    bitset<NUM_TOTAL_MOVES>("00000000000000010000000000000000000000000000000000"
                            "0000000001000000000001000000001110000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000011100000000000000001000000"
                            "0011100000000000000000000000001110000000001000"),
    bitset<NUM_TOTAL_MOVES>("00000000111000000000000000010000000000000000000000"
                            "0011111110000000001000000011101111000000001000"),
    bitset<NUM_TOTAL_MOVES>("00000000000100000000000000000000000000000000000000"
                            "0000011110000000001000000011100001000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000111000000000000000010000000011"
                            "1000000000000000000000000011100000000001000000"),
    bitset<NUM_TOTAL_MOVES>("00001110000000000000000100000000000000000000000011"
                            "1111100000000001000000111011110000000001000000"),
    bitset<NUM_TOTAL_MOVES>("00000001000000000000000000000000000000000000000000"
                            "0111100000000001000000111000010000000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000001110000000000000000100000000000000"
                            "0000000000000000000000111000000000001000000000"),
    bitset<NUM_TOTAL_MOVES>("11100000000000000001000000000000000000000000000011"
                            "1000000000001000000000111100000000001000000000"),
    bitset<NUM_TOTAL_MOVES>("00010000000000000000000000000000000000000000000011"
                            "1000000000001000000000000100000000000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000110000000000000000000"
                            "0000000110000000000000000000000000000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000001100000000000000000000000"
                            "0001100000000000000000000000000110000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000011000000000000000000000000001"
                            "1000000000000000000000000001100000000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000110000000000000000000000000000000"
                            "0000000000000000000000011000000000000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000001100000000000000000000000000000000000"
                            "0000000110000000000000000000000110000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000011000000000000000000000000000000000000000"
                            "0001100110000000000000000001100110000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000110000000000000000000000000000000000000000001"
                            "1001100000000000000000011001100000000000000000"),
    bitset<NUM_TOTAL_MOVES>("01100000000000000000000000000000000000000000000001"
                            "1000000000000000000000011000000000000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000000000000000000000000"
                            "0000000000000000000000000000000110000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000000000000000000000000"
                            "0000000110000000000000000001100000000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000000000000000000000000"
                            "0001100000000000000000011000000000000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000000000000000000000001"
                            "1000000000000000000000000000000000000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000100010001000100000000000000"
                            "0100000000000001001001000000000000000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000001000100010001000000000000000000000000000000"
                            "0100000000001001001001000100000000000001001001"),
    bitset<NUM_TOTAL_MOVES>("00010000000000000000000000000000000000000000000000"
                            "0000000000001000000000000100000000000001001001"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000001000100010001000000000000000"
                            "1000000000000010010010000000000000000001001001"),
    bitset<NUM_TOTAL_MOVES>("00000010001000100010000000000000000000000000000000"
                            "1000000000010011011011001000000000001011011011"),
    bitset<NUM_TOTAL_MOVES>("00100000000000000000000000000000000000000000000000"
                            "0000000000010001001001001000000000001010010010"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000010001000100010000000000000001"
                            "0000000000000100100100000000000000000010010010"),
    bitset<NUM_TOTAL_MOVES>("00000100010001000100000000000000000000000000000001"
                            "0000000000100110110110010000000000010110110110"),
    bitset<NUM_TOTAL_MOVES>("01000000000000000000000000000000000000000000000000"
                            "0000000000100010010010010000000000010100100100"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000100010001000100000000000000010"
                            "0000000000000000000000000000000000000100100100"),
    bitset<NUM_TOTAL_MOVES>("00001000100010001000000000000000000000000000000010"
                            "0000000000000100100100100000000000100100100100"),
    bitset<NUM_TOTAL_MOVES>("10000000000000000000000000000000000000000000000000"
                            "0000000000000100100100100000000000100000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000001000100010000000000000000000100"
                            "0000000000001001001000000000000001000000000000"),
    bitset<NUM_TOTAL_MOVES>("00010001000100000000000000000001000000000000000000"
                            "0000000001001001001001000000000001001001001000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000010000000000000000000000000000000000"
                            "0000000001000000000001000000000000001001001000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000010001000100000000000000000001000"
                            "0000000000010010010000000000000010001001001000"),
    bitset<NUM_TOTAL_MOVES>("00100010001000000000000000000010000000000000000000"
                            "0000000010011011011010000000000010011011011001"),
    bitset<NUM_TOTAL_MOVES>("00000000000000100000000000000000000000000000000000"
                            "0000000010001001001010000000000000010010010001"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000100010001000000000000000000010000"
                            "0000000000100100100000000000000100010010010000"),
    bitset<NUM_TOTAL_MOVES>("01000100010000000000000000000100000000000000000000"
                            "0000000100110110110100000000000100110110110010"),
    bitset<NUM_TOTAL_MOVES>("00000000000001000000000000000000000000000000000000"
                            "0000000100010010010100000000000000100100100010"),
    bitset<NUM_TOTAL_MOVES>("00000000000000001000100010000000000000000000100000"
                            "0000000000000000000000000000001000100100100000"),
    bitset<NUM_TOTAL_MOVES>("10001000100000000000000000001000000000000000000000"
                            "0000001000100100100000000000001000100100100100"),
    bitset<NUM_TOTAL_MOVES>("00000000000010000000000000000000000000000000000000"
                            "0000001000100100100000000000000000000000000100"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000100010000000000000000000000"
                            "0000000000000001001000000000000000000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000001000100000000000000000000000"
                            "0000000000000010010000000000000000000001001000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000010001000000000000000000000000"
                            "0000000000000100100000000000000000000010010000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000100010000000000000000000000000"
                            "0000000000000000000000000000000000000100100000"),
    bitset<NUM_TOTAL_MOVES>("00000001000100000000000000000000000000000000000000"
                            "0000000000000001001000000000000000000001001000"),
    bitset<NUM_TOTAL_MOVES>("00000010001000000000000000000000000000000000000000"
                            "0000000000000011011000000000000000000011011000"),
    bitset<NUM_TOTAL_MOVES>("00000100010000000000000000000000000000000000000000"
                            "0000000000000110110000000000000000000110110000"),
    bitset<NUM_TOTAL_MOVES>("00001000100000000000000000000000000000000000000000"
                            "0000000000000100100000000000000000000100100000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000000000000000000000000"
                            "0000000000000000000000000000000000000001001000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000000000000000000000000"
                            "0000000000000001001000000000000000000010010000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000000000000000000000000"
                            "0000000000000010010000000000000000000100100000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000000000000000000000000"
                            "0000000000000100100000000000000000000000000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000010000100001100000000000000001"
                            "0000100001000100010001000000000110000010001000"),
    bitset<NUM_TOTAL_MOVES>("00000100001000011000000000000000000000000000000001"
                            "0001100011000110011001110000100111100110011001"),
    bitset<NUM_TOTAL_MOVES>("10000000000000000000000000000000000000000000000000"
                            "0001000010000010001000110000100001100100010001"),
    bitset<NUM_TOTAL_MOVES>("00000000000000001000010000100000000000000000000101"
                            "0000100000000100010000100000000110100010001000"),
    bitset<NUM_TOTAL_MOVES>("10000100001000000000000000000001000000000000000011"
                            "0001100011100110011001110000100110100110011000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000010000000000000000000000000000000010"
                            "0001000011100010001001010000100000000100010000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000010000100000000000000000000001"
                            "0000100000000100010000000000000110000010001000"),
    bitset<NUM_TOTAL_MOVES>("00000100001000000000000000000000000000000000000001"
                            "0001100010000110011000010000100110000110011000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000000000000000000000000"
                            "0001000010000010001000010000100000000100010000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000001001001000000100000000000000"
                            "1001001000000010100000000000000110000001010100"),
    bitset<NUM_TOTAL_MOVES>("00000010010010000001000000000000000000000000000000"
                            "1001101100001011110100001101001110000011110100"),
    bitset<NUM_TOTAL_MOVES>("00010000000000000000000000000000000000000000000000"
                            "0000100100001001010100001101001000000010100000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000001001001000000000000000000100000"
                            "1001000000001010100000000100000110000001010000"),
    bitset<NUM_TOTAL_MOVES>("00010010010000000000000000001000000000000000000000"
                            "1101101100001011110000001101000110001011110100"),
    bitset<NUM_TOTAL_MOVES>("00000000000010000000000000000000000000000000000000"
                            "0100101100000001010000001001000000001010100100"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000001001000000000000000000000000"
                            "1001000000000010100000000000000110000001010000"),
    bitset<NUM_TOTAL_MOVES>("00000010010000000000000000000000000000000000000000"
                            "1001100100000011110000001001000110000011110000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000000000000000000000000"
                            "0000100100000001010000001001000000000010100000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000100100100000000000000000000"
                            "0100100100000001010100000000010010000000001010"),
    bitset<NUM_TOTAL_MOVES>("00000001001001000000000000000000000000000000000000"
                            "0100110110000001011110000100110110000001011110"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000000000000000000000000"
                            "0000010010000000001010000100100100000001010100"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000100001000010000000000000000010"
                            "0001000010000000100010000010000100000100010001"),
    bitset<NUM_TOTAL_MOVES>("00001000010000100000000000000000000000000000000010"
                            "0011000110000100110011100011000110000100110011"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000000000000000000000000"
                            "0010000100000100010001100001000010000000100010"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000010010010000000000000000000000001"
                            "0010000000010100000000001001001000001010100000"),
    bitset<NUM_TOTAL_MOVES>("00100100100000000000000000000000000000000000000001"
                            "1011001000011110100000011011001000011110100000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000000000000000000000000"
                            "1001001000001010100000010010000000010100000000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000100001000010000000000000000000000"
                            "1000010000100010001000010000100001010001000000"),
    bitset<NUM_TOTAL_MOVES>("01000010000100000000000000000000000000000000000001"
                            "1000110001110011001000011000110001110011001000"),
    bitset<NUM_TOTAL_MOVES>("00000000000000000000000000000000000000000000000001"
                            "0000100001010001000000001000010000100010001000"),
};

const uintf GAMMA_BUCKETS = 128;

const float gamma_samples[GAMMA_BUCKETS] = {
    1.5224955735394764e-08, 2.916839930596267e-07,  1.4716636845531811e-06,
    4.408333320532792e-06,  1.0084245417682108e-05, 1.9582982829837853e-05,
    3.4072927038818216e-05, 5.479644051833544e-05,  8.306205676119949e-05,
    0.00012023855323316914, 0.00016775030075804627, 0.0002270735301996222,
    0.0002997332890991329,  0.0003873009369685033,  0.0004913920745715346,
    0.0006136648325400066,  0.0007558184647728278,  0.0009195922059839439,
    0.0011067643626791416,  0.001319151614086149,   0.0015586085049743203,
    0.0018270271164297796,  0.0021263369038628873,  0.002458504694073895,
    0.0028255348352584225,  0.0032294694955294165,  0.003672389106955825,
    0.00415641295333505,    0.004683699900982771,   0.0052564492727806824,
    0.005876901866584054,   0.006547341119906957,   0.007270094423577854,
    0.008047534587802871,   0.00888208146481661,    0.009776203733049939,
    0.010732420848483611,   0.011753305169670557,   0.012841484263709183,
    0.01399964340128885,    0.015230528249859904,   0.016536947775087334,
    0.017921777361342053,   0.019387962163693,      0.0209385207049208,
    0.022576548731894377,   0.02430522334780461,    0.026127807437930174,
    0.028047654408377927,   0.03006821325921657,    0.03219303401541758,
    0.03442577354137599,    0.03677020176722627,    0.03923020835804173,
    0.04180980986008108,    0.04451315736158648,    0.04734454470954764,
    0.05030841732801328,    0.05340938168828568,    0.05665221548649293,
    0.060041878590094216,   0.06358352482124488,    0.06728251465243411,
    0.07114442889817028,    0.0751750834956215,     0.0793805454778449,
    0.08376715025498034,    0.08834152033232448,    0.09311058560936145,
    0.09808160542129306,    0.10326219250432397,    0.1086603390882731,
    0.11428444534620105,    0.12014335046010655,    0.12624636659560032,
    0.13260331611782883,    0.13922457242590336,    0.1461211048354257,
    0.15330452799949107,    0.1607871564293883,     0.16858206475853846,
    0.1767031544901539,     0.18516522808299712,    0.19398407136337154,
    0.20317654541033878,    0.21276068924941158,    0.2227558349146763,
    0.23318273670794273,    0.24406371680619526,    0.2554228297580473,
    0.26728604888247653,    0.2796814781576907,     0.2926395938918174,
    0.30619352133293826,    0.32037935244686727,    0.33523651242403846,
    0.35080818414475684,    0.3671418019344077,     0.3842896286073007,
    0.4023094332068462,     0.4212652912381474,     0.44122853489176983,
    0.46227888822628904,    0.48450583215357035,    0.508010257273147,
    0.5329064804261577,     0.5593247252058221,     0.5874142003920098,
    0.6173469576157008,     0.6493227770208473,     0.6835754274152013,
    0.7203807915766329,     0.7600675643968324,     0.8030315655661644,
    0.8497552356363302,     0.900834739887093,      0.9570185381767934,
    1.019263771074522,      1.0888213317743676,     1.1673691062598068,
    1.257230281927162,      1.3617514813860707,     1.4860054971445251,
    1.6382237843381706,     1.8331149814452394,     2.101179761100073,
    2.5253211251309686,     3.7052067984463357,
};

#endif